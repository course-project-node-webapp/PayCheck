"use strict";!function(){function t(t){if(!validator.isLength(t,{min:u,max:l}))throw new Error("Username must be between "+u+" and "+l+" letters long.");if(!validator.isAlphanumeric(t))throw new Error("Username can consist of letters and digits only.")}function r(t){if(!validator.isLength(t,{min:m,max:p}))throw new Error("Password must be between "+m+" and "+p+" characters long.")}function e(t){if(!validator.isURL(t))throw new Error("Profile picture must be a valid URL.")}toastr.options.preventDuplicates=!0;var n=$("input#tb-username"),o=$("input#tb-profile-pic"),s=$("input#tb-new-password"),i=$("input#tb-confirm-password"),a=$("#settings-container a.btn.save-changes-btn"),c=userConstants,u=c.MIN_NAME_LENGTH,l=c.MAX_NAME_LENGTH,m=c.MIN_PASS_LENGTH,p=c.MAX_PASS_LENGTH;$(document).on("keydown",function(t){var r=13,e=t.keyCode||t.which;e===r&&a.trigger("click")}),a.on("click",function(){var a={},c=n.val(),u=o.val(),l=s.val(),m=i.val();return Promise.resolve().then(function(){if(!m)throw new Error("You must confirm your password to continue.");return u&&(e(u),a.image=u),c&&(t(c),a.username=validator.escape(c)),l&&(r(l),a.password=CryptoJS.SHA256(l).toString()),r(m),a.passwordConfirm=CryptoJS.SHA256(m).toString(),requester.putJSON("/account/update",a)}).then(function(t){toastr.success(t.message),setTimeout(function(){window.location=t.redirectUrl},1500)}).catch(function(t){t.message?toastr.error(t.message):t.responseText&&toastr.error(t.responseText)})})}();